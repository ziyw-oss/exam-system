# 🧪 学生考试流程开发文档（阶段 1）

学生可以进行两种考试模式：

1. ✅ **完整试卷考试**：从历年试卷中选择整套练习。
2. ✅ **按知识点考试**：选择指定的知识点，系统自动生成试题集合。

---

## 🛠️ 开发步骤一览

### 1️⃣ 考试入口页面 `/exam/start`
- 显示考试模式选项（完整试卷 / 按知识点）
- 选择后跳转至对应设置页面

---

### 2️⃣ 试卷选择 / 知识点选择页面

#### 🔹 完整试卷模式
- 显示考试列表（来自 `exams` 表）
- 点击选择后跳转到答题页

#### 🔸 知识点模式
- 显示章节/知识点树结构（`keypoints` 表）
- 学生选择知识点范围 + 题量
- 系统从 `question_bank` 中随机出题

---

### 3️⃣ 考试设置页 `/exam/setup`（⏱️ 新增）

- 显示考试时长设置项：
  - 30分钟 / 60分钟 / 自定义时长（单位：分钟）
- 保存考试 session 数据，启动倒计时
- 页面展示：
  - ✅ 剩余时间
  - ✅ 答题进度

---

### 4️⃣ 考试答题页面 `/exam/[session_id]`

- 一题一页或分页答题模式（支持选择）
- 每题作答后保存至 `student_answers`
- 实时更新页面顶部信息：
  - ⏳ 剩余时间倒计时
  - 📊 已完成/总题目数（如 4/10）

---

### 5️⃣ 中途暂停与续考功能（🛑 新增）

- 学生点击“暂停考试”：
  - session 状态更新为 `paused`
  - 保存当前进度 + 剩余时间
- 登录后进入 `/exam/start`，检测有未完成考试时：
  - 提示继续
  - 进入当前 session 并恢复进度 + 倒计时

---

### 6️⃣ 自动评分与交卷处理

- 系统判分（选择题、判断题自动判）
- 主观题进入待评状态
- 成绩保存至 `exam_results`，答题存至 `student_answers`

---

### 7️⃣ 考试报告页 `/report/[session_id]`

- 展示数据包括：
  - 总分、得分率、是否及格
  - 各知识点得分
  - 错误率高的知识点（建议复习）

---

## 🧩 涉及数据库表设计

### 表：`exam_sessions`（新增）

| 字段名         | 类型     | 说明 |
|----------------|----------|------|
| id             | int      | 考试 Session ID |
| user_id        | int      | 所属学生 ID |
| exam_id        | int/null | 所属试卷（如为整卷考试） |
| keypoint_ids   | text     | 知识点 ID 列表（知识点考试） |
| duration_min   | int      | 学生设定的考试时间（分钟） |
| time_left      | int      | 当前剩余时间（秒） |
| status         | enum     | `in_progress` / `paused` / `completed` |
| started_at     | datetime | 开始时间 |
| updated_at     | datetime | 最后更新时间 |

---

### 表：`student_answers`（扩展）

| 字段名       | 类型     | 说明 |
|--------------|----------|------|
| session_id   | int      | 考试 Session ID |
| question_id  | int      | 题目 ID |
| answer_text  | text     | 学生答案 |
| is_correct   | boolean  | 是否正确（自动评分） |
| answered_at  | datetime | 答题时间 |

---

## ✅ 特性小结

| 功能                         | 状态 |
|------------------------------|------|
| ✅ 学生自定义考试时长        | ✅ 支持 |
| ✅ 倒计时显示                 | ✅ 支持 |
| ✅ 支持中途暂停考试          | ✅ 支持 |
| ✅ 记录剩余时间与进度        | ✅ 支持 |
| ✅ 登录后继续未完成考试      | ✅ 支持 |
| ✅ 实时更新题目完成情况      | ✅ 支持 |

---

## 📌 后续功能预告（阶段 2）

- 主观题评分后台管理
- 错题本功能
- 进度曲线图（学习趋势）
- 知识点推荐练习
